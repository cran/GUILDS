<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Thijs Janzen" />

<meta name="date" content="2022-02-24" />

<title>GUILDS Vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">GUILDS Vignette</h1>
<h4 class="author">Thijs Janzen</h4>
<h4 class="date">2022-02-24</h4>



<div id="guilds-vignette" class="section level2">
<h2>Guilds Vignette</h2>
<p>Welcome to the vignette of GUILDS. GUILDS is an R package aimed at
providing the user with easy to use functions that help dealing with the
Unified Neutral Theory of Biodiversity and Biogeography. More
specifically, the package bundles together the sampling functions for
the Neutral Model including multiple guilds that differ in dispersal
ability (Janzen et al.Â 2015), and the Etienne sampling formula for the
standard neutral model. Furthermore, the package contains functions to
generate artificial datasets, and to calculate the expected
abundances.</p>
</div>
<div id="the-standard-neutral-model" class="section level2">
<h2>The standard neutral model</h2>
<p>To generate data with the standard neutral model, we can make use of
the function <code>generate.ESF</code>, where ESF stands for the Etienne
Sampling Formula. generate.ESF makes use of the urn scheme described in
Etienne (2005), where the avid reader can also find more details on the
Etienne Sampling Formula. The ESF combines the universal biodiversity
number theta, and the universal dispersal number I. Typically, the
migration rate is a bit easier to interpret, so we will make use of that
first, then convert it to I, and then generate the data:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GUILDS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> m <span class="sc">*</span> (J <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> m)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>abund <span class="ot">&lt;-</span> <span class="fu">generate.ESF</span>(theta, I, J)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>abund</span></code></pre></div>
<pre><code>##   [1] 875 238 212 177 176 172 159 158 149 145 144 126 124 122 117 112 111 110
##  [19] 110 109 108 108 106 101  99  95  93  92  86  80  80  79  78  77  76  75
##  [37]  70  68  66  63  62  60  60  59  59  58  57  57  56  56  55  54  54  53
##  [55]  52  51  51  50  48  47  46  46  45  44  44  43  43  43  43  42  42  41
##  [73]  40  40  39  39  39  37  37  37  36  36  35  35  34  34  34  33  33  31
##  [91]  31  30  30  30  30  30  29  29  28  28  28  27  26  26  26  26  26  26
## [109]  26  25  25  24  24  24  24  24  24  23  22  22  22  21  21  21  21  20
## [127]  20  20  20  20  20  20  20  19  19  19  19  18  18  18  18  17  17  17
## [145]  17  17  17  16  16  16  16  16  16  15  15  15  15  15  14  14  14  13
## [163]  13  13  12  12  12  12  12  12  12  11  11  11  11  11  11  10  10  10
## [181]  10  10   9   9   9   9   9   9   9   9   8   8   8   8   8   8   8   8
## [199]   8   8   8   8   8   7   7   7   7   7   7   7   7   7   7   7   7   6
## [217]   6   6   6   6   6   6   6   5   5   5   5   5   5   5   5   5   5   5
## [235]   5   5   5   5   5   4   4   4   4   4   4   4   4   4   4   4   4   4
## [253]   4   4   4   4   4   4   3   3   3   3   3   3   3   3   3   3   3   3
## [271]   3   3   3   3   3   3   3   3   3   3   2   2   2   2   2   2   2   2
## [289]   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2
## [307]   2   2   2   2   1   1   1   1   1   1   1   1   1   1   1   1   1   1
## [325]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
## [343]   1</code></pre>
<p>The package has now generated a nice species abundance distribution.
Using the function `<code>preston_plot</code> we can visualize our
abundance distribution</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">preston_plot</span>(abund)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can even do better, using the function <code>expected.SAD</code>
we can calculate the expected number of individuals per species.
Furthermore, we can easily add this to our plot:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>abund.expect <span class="ot">&lt;-</span> <span class="fu">expected.SAD</span>(theta, m, J)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">preston_plot</span>(abund, abund.expect)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAAEDmlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPpu5syskzoPUpqaSDv41lLRsUtGE2uj+ZbNt3CyTbLRBkMns3Z1pJjPj/KRpKT4UQRDBqOCT4P9bwSchaqvtiy2itFCiBIMo+ND6R6HSFwnruTOzu5O4a73L3PnmnO9+595z7t4LkLgsW5beJQIsGq4t5dPis8fmxMQ6dMF90A190C0rjpUqlSYBG+PCv9rt7yDG3tf2t/f/Z+uuUEcBiN2F2Kw4yiLiZQD+FcWyXYAEQfvICddi+AnEO2ycIOISw7UAVxieD/Cyz5mRMohfRSwoqoz+xNuIB+cj9loEB3Pw2448NaitKSLLRck2q5pOI9O9g/t/tkXda8Tbg0+PszB9FN8DuPaXKnKW4YcQn1Xk3HSIry5ps8UQ/2W5aQnxIwBdu7yFcgrxPsRjVXu8HOh0qao30cArp9SZZxDfg3h1wTzKxu5E/LUxX5wKdX5SnAzmDx4A4OIqLbB69yMesE1pKojLjVdoNsfyiPi45hZmAn3uLWdpOtfQOaVmikEs7ovj8hFWpz7EV6mel0L9Xy23FMYlPYZenAx0yDB1/PX6dledmQjikjkXCxqMJS9WtfFCyH9XtSekEF+2dH+P4tzITduTygGfv58a5VCTH5PtXD7EFZiNyUDBhHnsFTBgE0SQIA9pfFtgo6cKGuhooeilaKH41eDs38Ip+f4At1Rq/sjr6NEwQqb/I/DQqsLvaFUjvAx+eWirddAJZnAj1DFJL0mSg/gcIpPkMBkhoyCSJ8lTZIxk0TpKDjXHliJzZPO50dR5ASNSnzeLvIvod0HG/mdkmOC0z8VKnzcQ2M/Yz2vKldduXjp9bleLu0ZWn7vWc+l0JGcaai10yNrUnXLP/8Jf59ewX+c3Wgz+B34Df+vbVrc16zTMVgp9um9bxEfzPU5kPqUtVWxhs6OiWTVW+gIfywB9uXi7CGcGW/zk98k/kmvJ95IfJn/j3uQ+4c5zn3Kfcd+AyF3gLnJfcl9xH3OfR2rUee80a+6vo7EK5mmXUdyfQlrYLTwoZIU9wsPCZEtP6BWGhAlhL3p2N6sTjRdduwbHsG9kq32sgBepc+xurLPW4T9URpYGJ3ym4+8zA05u44QjST8ZIoVtu3qE7fWmdn5LPdqvgcZz8Ww8BWJ8X3w0PhQ/wnCDGd+LvlHs8dRy6bLLDuKMaZ20tZrqisPJ5ONiCq8yKhYM5cCgKOu66Lsc0aYOtZdo5QCwezI4wm9J/v0X23mlZXOfBjj8Jzv3WrY5D+CsA9D7aMs2gGfjve8ArD6mePZSeCfEYt8CONWDw8FXTxrPqx/r9Vt4biXeANh8vV7/+/16ffMD1N8AuKD/A/8leAvFY9bLAAAAOGVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAACoAIABAAAAAEAAAEgoAMABAAAAAEAAAEgAAAAAKtAJY0AACQNSURBVHgB7Z0JlBRFtoZviwuyqCCIsghuB1EURFnEZrUBQQFBEFEUxpGB4+CMwyijIkorOjoueFxQUWQTFRFkUVSgBVFQUQeQkUUYm12QRdkRh8mXf7yX/aqru7oysrMqKqr+e051dVXFkvFl1l+Rsdyb5bgmNBIgARIwQOAYA3WyShIgARJQBChAvBBIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEaAAGUPPikmABChAvAZIgASMEbBegBzHkR07dsju3buNQWTFJEACwQgcGyyb2VxbtmyRZ599ViZPniz4/z//+Y86oJNOOknq1KkjOTk5kpubKxUqVDB7oBlW+6233irffPONHHus/mW1a9cuGTFihPTp0yfDqGV2c7PcHoRjE4INGzZIdna2ZGVlSc+ePeXss8+WypUrq9foBeXn58s777wjaFZeXp6cc845NjXP6mM94YQTZPjw4VKmTBntdmzbtk2+/fZbmTdvnnZeZrCXgP5PleG2PvHEE6qXgwsVF3xx9uijj0rHjh1lwoQJqidUXBq+Fz6B448/XmrXri3ly5fXLnzv3r2BhEu7ImZIKQLWjQEtW7ZMbrnllpjiA7rHHXec9OvXTz788MOUgs2DIQESKEzAOgFq3ry5LFq0qHArinn18ccfS40aNYr5hG+RAAmkCgHrbsFuvPFGgQht375dbrrpJjXGc+qpp8oxxxyjZsLWr18vkyZNktmzZ3M8IVWuMh4HCcQgYJ0ANWzYUA1WDhgwQPr27Sv//e9/izQNs2Bz5syRVq1aFfmMb5AACaQOAesECOjOPfdcNcN15MgR2bhxo6DX89tvv0n16tWlZs2agh5RUJsxY4Y88MADcbOj3ldffVWuu+66uGmZgARIoHgCVgqQ1xTMukCM8ID99NNPJQ5Oe/lKem7ZsqVMnDixpCTqM6xXKY3Qxa2ACUggAwhYKUBLliyRhx56SN58802pWLGizJo1S+644w7BGiGsQWnQoIE888wz0qJFC+1TWKlSJcEjnmGquWzZsvGS8XMSIIESCFg3C/bll19Ks2bN5OjRo6pZX3zxhXTr1k31RrBGaOTIkWoFdPv27eXTTz8toen8iARIwDQB63pA6PVcc801MnPmTMVu9OjRcvrppwuEydsCgN4QBqLHjRsXqBdk+qSwfhLIFALW9YC+/vprueqqqwrOzy+//CJdu3YtEB/vA0zXY9EijQRIIHUJ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" /><!-- --></p>
<p>We can clearly see that the simulated abundance distribution closely
matches the expected distribution (the black line), although the
stochastic nature of the simulation has caused some small deviations.
Using the Etienne Sampling Formula we can now estimate theta and m,
using maximum likelihood. Because we already know the real values (those
are the values that we used to simulate the data), we can nicely
crosscheck whether the Etienne Sampling Formula yields good results. We
start the maximum likelihood at three different starting points, to
compare convergence.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>LL1 <span class="ot">&lt;-</span> <span class="fu">maxLikelihood.ESF</span>(<span class="at">init_vals =</span> <span class="fu">c</span>(theta, m),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                         abund, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>LL2 <span class="ot">&lt;-</span> <span class="fu">maxLikelihood.ESF</span>(<span class="at">init_vals =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="fl">0.001</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                         abund, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>LL3 <span class="ot">&lt;-</span> <span class="fu">maxLikelihood.ESF</span>(<span class="at">init_vals =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="fl">0.9</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                         abund, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LL1<span class="sc">$</span>par</span></code></pre></div>
<pre><code>## [1] 102.0694269   0.1158251</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>LL2<span class="sc">$</span>par</span></code></pre></div>
<pre><code>## [1] 102.0694029   0.1158252</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>LL3<span class="sc">$</span>par</span></code></pre></div>
<pre><code>## [1] 102.069449   0.115825</code></pre>
<p>Regardless of the starting point, we recover the same parameter
estimates that are close to the real values theta = 100 and m = 0.1
.</p>
</div>
<div id="dispersal-guilds" class="section level2">
<h2>Dispersal Guilds</h2>
<p>The guilds model, as described in Janzen et al.Â (2015), asks a
slightly different question from the standard neutral model. How would
species abundances look if there would be two guilds of species, where
the guilds would only differ in dispersal ability? Imagine for instance
a forest, where some tree species disperse using wind-aided seed
dispersal, and other tree species disperse using animal-aided seed
dispersal. The model assumes that the two guilds share a local
community, and the metacommunity, and share the same speciation dynamics
(e.g.Â have the same theta). Dispersal is different however, and in
contrast to the standard neutral model, where we would infer migration
rates, here we asses the dispersal ability: the guilds model postulates
that migration (m) is the product of the dispersal ability of the
species (alpha) and the speciesâ frequency in the metacommunity (p).</p>
<div id="conditioning-on-guild-size" class="section level3">
<h3>Conditioning on Guild size</h3>
<p>In the paper, we show that in order for parameter estimation to work
reliably, we have to condition our sampling formulaâs on guild size. The
package also contains sampling formulaâs without guild size, in order
for the user to reproduce our train of thought, but here we will focus
solely on situations where we have conditioned our sampling formulaâs on
guild size, and hence we assume that the user knows the number of
individuals per guild.</p>
<p>So, without verder ado, letâs simulate some data and then apply the
relevant sampling formulaâs. We start by simulating data using the âD0â
model, which assumes no differences in dispersal ability between the
guilds (e.g.Â the guilds model then reduces to the standard neutral
model)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>alpha_x <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>J_x <span class="ot">&lt;-</span> <span class="dv">8000</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>J_y <span class="ot">&lt;-</span> J <span class="sc">-</span> J_x</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>abund <span class="ot">&lt;-</span> <span class="fu">generate.Guilds.Cond</span>(theta, alpha_x, alpha_x, J_x, J_y)</span></code></pre></div>
<p>Again, we can calculate the expected distributions, and visualize our
distributions. This time however, a small part of the calculation of the
expected distribution can not be treated analytically, and has to be
done via the means of simulation, so a larger number of replicates means
a more accurate expected distribution. Here we will use a low number of
replicates for computational reasons.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>abund.expected <span class="ot">&lt;-</span> <span class="fu">expected.SAD.Guilds.Conditional</span>(theta, alpha_x, alpha_x,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                                                  J_x, J_y, <span class="at">n_replicates =</span> <span class="dv">5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">preston_plot</span>(abund<span class="sc">$</span>guildX, abund.expected<span class="sc">$</span>guildX, <span class="at">main =</span> <span class="st">&quot;Guild X&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">preston_plot</span>(abund<span class="sc">$</span>guildY, abund.expected<span class="sc">$</span>guildY, <span class="at">main =</span> <span class="st">&quot;Guild Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Before, we set the size of Guild X to 8000 individuals, and the size
of Guild Y to 2000 individuals. From the Preston plots we notice that
indeed Guild X contains more species, but that apart from that, there
are not many striking differences (we assumed equal dispersal of
course!) Now that we have our data, we can apply the guildsâ sampling
formula, and see whether it can accruately infer parameter values.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>LL <span class="ot">&lt;-</span> <span class="fu">maxLikelihood.Guilds.Conditional</span>(<span class="at">init_vals =</span> <span class="fu">c</span>(theta, alpha_x), </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">model =</span> <span class="st">&quot;D0&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sadx =</span> abund<span class="sc">$</span>guildX, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sady =</span> abund<span class="sc">$</span>guildY,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>LL<span class="sc">$</span>par</span></code></pre></div>
<pre><code>## [1] 179.7030482   0.1006566</code></pre>
<p>We see that the maximum likelihood algorithm accurately infers the
value of alpha, and gets relatively close to inferring the right value
of theta. If we would want to infer the rate of migration, we could, in
this case, also apply the standard neutral model (after all, there were
no differences in dispersal, rendering the guilds construction
obsolete):</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>LL1 <span class="ot">&lt;-</span> <span class="fu">maxLikelihood.ESF</span>(<span class="at">init_vals =</span> <span class="fu">c</span>(theta, alpha_x),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">abund =</span> <span class="fu">c</span>(abund<span class="sc">$</span>guildX, abund<span class="sc">$</span>guildY), </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>LL1<span class="sc">$</span>par</span></code></pre></div>
<pre><code>## [1] 246.0580922   0.2132826</code></pre>
<p>Using the ESF, we find a slightly higher estimate for theta (but
notice that the mean of the two estimates becomes really close to the
value we put in), and we find a higher value for m.</p>
</div>
<div id="guilds-model-with-differences-in-dispersal" class="section level3">
<h3>Guilds model with differences in dispersal</h3>
<p>So, what happens if we assume differences in dispersal? Letâs, for
fun, assume that there are two guilds (guild X and Y), where guild X is
much bigger, but where species from guild X have a much lower dispersal
ability:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">666</span> <span class="sc">+</span> <span class="dv">42</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>alpha_x <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>alpha_y <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>J_x <span class="ot">&lt;-</span> <span class="dv">8000</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>J_y <span class="ot">&lt;-</span> J <span class="sc">-</span> J_x</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>abund <span class="ot">&lt;-</span> <span class="fu">generate.Guilds.Cond</span>(theta, alpha_x, alpha_y, J_x, J_y)</span></code></pre></div>
<p>This generates the following dataset:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>abund.expected <span class="ot">&lt;-</span> <span class="fu">expected.SAD.Guilds.Conditional</span>(theta, alpha_x, alpha_y,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                                                  J_x, J_y, <span class="at">n_replicates =</span> <span class="dv">5</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">preston_plot</span>(abund<span class="sc">$</span>guildX, abund.expected<span class="sc">$</span>guildX, <span class="at">main =</span> <span class="st">&quot;Guild X&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">preston_plot</span>(abund<span class="sc">$</span>guildY, abund.expected<span class="sc">$</span>guildY, <span class="at">main =</span> <span class="st">&quot;Guild Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAAEDmlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPpu5syskzoPUpqaSDv41lLRsUtGE2uj+ZbNt3CyTbLRBkMns3Z1pJjPj/KRpKT4UQRDBqOCT4P9bwSchaqvtiy2itFCiBIMo+ND6R6HSFwnruTOzu5O4a73L3PnmnO9+595z7t4LkLgsW5beJQIsGq4t5dPis8fmxMQ6dMF90A190C0rjpUqlSYBG+PCv9rt7yDG3tf2t/f/Z+uuUEcBiN2F2Kw4yiLiZQD+FcWyXYAEQfvICddi+AnEO2ycIOISw7UAVxieD/Cyz5mRMohfRSwoqoz+xNuIB+cj9loEB3Pw2448NaitKSLLRck2q5pOI9O9g/t/tkXda8Tbg0+PszB9FN8DuPaXKnKW4YcQn1Xk3HSIry5ps8UQ/2W5aQnxIwBdu7yFcgrxPsRjVXu8HOh0qao30cArp9SZZxDfg3h1wTzKxu5E/LUxX5wKdX5SnAzmDx4A4OIqLbB69yMesE1pKojLjVdoNsfyiPi45hZmAn3uLWdpOtfQOaVmikEs7ovj8hFWpz7EV6mel0L9Xy23FMYlPYZenAx0yDB1/PX6dledmQjikjkXCxqMJS9WtfFCyH9XtSekEF+2dH+P4tzITduTygGfv58a5VCTH5PtXD7EFZiNyUDBhHnsFTBgE0SQIA9pfFtgo6cKGuhooeilaKH41eDs38Ip+f4At1Rq/sjr6NEwQqb/I/DQqsLvaFUjvAx+eWirddAJZnAj1DFJL0mSg/gcIpPkMBkhoyCSJ8lTZIxk0TpKDjXHliJzZPO50dR5ASNSnzeLvIvod0HG/mdkmOC0z8VKnzcQ2M/Yz2vKldduXjp9bleLu0ZWn7vWc+l0JGcaai10yNrUnXLP/8Jf59ewX+c3Wgz+B34Df+vbVrc16zTMVgp9um9bxEfzPU5kPqUtVWxhs6OiWTVW+gIfywB9uXi7CGcGW/zk98k/kmvJ95IfJn/j3uQ+4c5zn3Kfcd+AyF3gLnJfcl9xH3OfR2rUee80a+6vo7EK5mmXUdyfQlrYLTwoZIU9wsPCZEtP6BWGhAlhL3p2N6sTjRdduwbHsG9kq32sgBepc+xurLPW4T9URpYGJ3ym4+8zA05u44QjST8ZIoVtu3qE7fWmdn5LPdqvgcZz8Ww8BWJ8X3w0PhQ/wnCDGd+LvlHs8dRy6bLLDuKMaZ20tZrqisPJ5ONiCq8yKhYM5cCgKOu66Lsc0aYOtZdo5QCwezI4wm9J/v0X23mlZXOfBjj8Jzv3WrY5D+CsA9D7aMs2gGfjve8ArD6mePZSeCfEYt8CONWDw8FXTxrPqx/r9Vt4biXeANh8vV7/+/16ffMD1N8AuKD/A/8leAvFY9bLAAAAOGVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAACoAIABAAAAAEAAAEgoAMABAAAAAEAAAEgAAAAAKtAJY0AACjlSURBVHgB7Z0J/M1V/v/f9j0UY886ZM1SiBBJmUmIbxoMRqQMYohQ6WtQWTLIGAplyT6Vxr6OZQbDZKtkiezZIksJff+f1/n/Pnfuvd97v/d+7r3f+/mcz32dx+PyWc7nfM55nvN9fc76PhlSDCd0JEACJGADgYw2vJOvJAESIAFFgALEgkACJGAbAQqQbej5YhIgAQoQywAJkIBtBChAtqHni0mABChALAMkQAK2EaAA2YaeLyYBEqAAsQyQAAnYRoACZBt6vpgESIACxDJAAiRgGwEKkG3o+WISIAEKEMsACZCAbQQoQLah54tJgAQoQCwDJEACthGgANmGni8mARKgALEMkAAJ2EaAAmQber6YBEiAAsQyQAIkYBsBCpBt6PliEiABChDLAAmQgG0EKEC2oeeLSYAEKEAsAyRAArYRoADZhp4vJgESoACxDJAACdhGgAJkG3q+mARIgALEMkACJGAbAQqQbej5YhIgAQoQywAJkIBtBChAtqHni0mABChALAMkQAK2EaAA2YaeLyYBEqAAsQyQAAnYRiAhBejixYvyt7/9TZ577jmpVq2a5M+fX6pUqSJt27aVjRs3Rp0Zo0ePliZNmqjfL7/8osL77rvvPNdmzpwZ8h3eYaSkpAT13717d0+4n376aSp/EyZM8NwfM2ZMqvu8YJ2AW8rP9u3bPWXj6aeflp9//jkVjAsXLkizZs2UP/x//vz5VH6iumAU7oRyGzZsSClatCj+ooP+unXrFhWTLl26eMK+ffu2CuvYsWOea6+++mrI8L3DuHPnTlD/69ev94RbpEiRlMuXL3v8Hjx4MCVbtmzqfp48eVJOnDjhuceDyAi4rfwYH0pP+XnrrbdSQenRo4fn/sCBA1Pdj/ZC5qjUS7OHv/76a2nRooVcu3ZNxfzBBx+Upk2bSq5cuWTVqlXyr3/9S4w/dnn//felcuXK0rdv34hSWKNGDbl06ZJ6NkOGDBGFEe5DjRs3FkMwVZzPnDkjQ4YMkcmTJ6vHe/bsKTdv3lTHb775phQvXjzcYOkvAAE3lp+pU6dK1apV5aeffpIRI0ZIx44dpVixYir1u3fvlvfee08dlylTRt54440AVKK8FK2C6fR8w4YNPWo+bNiwFKN55BN9IzM89w3gqe77eLZ4EqoGdOvWrZSjR4+mmLWdcGtAiAZqPWatLmPGjCnbtm1LmT9/vict9erV84RrMdr07kXAreVn1KhRnrLy7LPPelLcoEEDz/XVq1d7rsfyQGIZmJPDMr5eHphGDSXoH6TRT5Iye/bslH379nkEaP/+/SlGLUn9/vKXv/gk02gXq+sVK1b0XEe11fQfqgl2/fr1FKMfJyV79uwqfmgqjRw5MqVTp06e+Jqi5HlBgINPPvnE49/4oqWgOWZ8m1KyZs2a8sUXXwR4gpesEHBz+TH6flJQZlBe8EMzc968eZ5zo1ZkBZUlvwnTBDOgeuqKSUlJYtQUPOfeBwMGDPA+VcfoSDaEQh0bNRWf+6i64t6NGzc819HsMf17LgY5aNOmjaxcuVLdNZtrQ4cOFaPvJsgTgS+3bNlSnnnmGVm4cKEY4unxhCZZpUqVPOc8iIyAm8tPlixZZNq0aVK/fn1BWe/Vq5f88MMPCtQ999wj48ePjwxaGE8ljAAZHbAeHGjPejujI1dOnjzpfUkdP/bYY2LUJFJdj9UFvNcUn4ceekj145QoUULGjh0rw4cPt/yaSZMmyYoVK+Tq1avqWQjP4MGDLYfDB1ITcHv5qVu3rrz44ouq/9CoMXsAvPPOO1KgQAHPeawPEkaAvGsuRh3Rh+O4ceNk+fLlPtdwYrR701WAvL+qvXv39tRUkpOTZdGiRfLVV1+lilNaF+Df7GCHP6NvSNXMjGZYWo/xXhgEEqH8GH1BYjTl5dSpU4rIo48+KkZXQBh0IvcSuB0SeXiOfdLs2UcEjQ5hn3jmzJlTjL4X9Qv1x+ovXuY8H58Awzz55ptvPD4xx8LbWW02/fjjj2pek3f8Tp8+Lf369fMOlscREnB7+QGWu+66S7p27eoh9Kc//clznF4HCSNAaN+azr+2g9oG2rz4hYJudCqbwaj/zWFun4thnph9PvCOqQDeDrUXK86YWyRHjhxRj2ASpDEqpo4/+OCDgLU7K2HTr6j+EZODG8uPmbbMmf/XKELfUHq7hBGgWrVqiTFSpXhu3rxZjGHqgGzPnTuX6nqOHDk817ybOLiIuTeRunLlynkeNUbaPMfo0N6yZYvnPNSBMewuxuic8gYhmzFjhmcuEC4+//zzcuXKlVDB8H4aBNxcftJIdrrfShgBAsmPP/5YChYsqKC2b99e+vTpo/p5du3aJdOnT1dfOfzx+rtSpUqJ2TTD1w9T1tHUmThxYsDOa//ng517N7tQ80KtBz+MXIVbs4I/LCkxm4LGEL6ULFlSWrVqpZaW4N1o04eq2QWLI6//j4Aby8//UmfTkfGHlFDOEJsUo63rmeNgYE91bFRDU4xZ0ClGk8zDplGjRh5/+fLlU/NsjCZUSunSpdV144/e49d7EmGoeUDG+jNPuHgv5g8hTgjPjFta84CMIXuPvzp16vjMbzJqZymIqxmOMULmiSMPIiPgtvLjT8EYAPGUl/SafOj9zoSqARl/iFKzZk3B6BPmApm1GlzPlCmTWn7RuXNn2bNnj5r7gI5p06GfCEOV6LdBLQX+FyxYoJZ2mH4i+X/OnDmqiYS2N/qXMD8JyybCWQaCqfJvv/22ei3a61hC4j2/qXDhwmpI34wXFq6a8zvMa/zfGgE3lR9rKU8f3xmgRukTtPNDRVMK83/wR1mhQgXx7usJFnushIZ/o+YTzEtE1zGKZSzFkPLly4t3R2BEgfGhuBBg+Ykec0ILUPT4GAIJkEA0BBKuCRYNLD5LAiQQWwIUoNjyZGgkQAIWCFCALMCiVxIggdgSoADFlidDIwESsECAAmQBFr2SAAnElgAFKLY8GRoJkIAFAhQgC7DolQRIILYEKECx5cnQSIAELBCgAFmARa8kQAKxJUABii1PhkYCJGCBAAXIAix6JQESiC0BClBseTI0EiABCwQoQBZg0SsJkEBsCVCAYsuToZEACVggQAGyAIteSYAEYkuAAhRbngyNBEjAAgEKkAVY9EoCJBBbAhSg2PJkaCRAAhYIUIAswKJXEiCB2BKgAMWWJ0MjARKwQIACZAEWvZIACcSWAAUotjwZGgmQgAUCFCALsOiVBEggtgQoQLHlydBIgAQsEKAAWYBFryRAArElQAGKLU+GphkB7Ex+/vx5uXTpkmYxd0d0KUDuyEemwgKBU6dOyaBBg6RUqVKSNWtW+dWvfiX33HOP5M2bV+6//37p37+/XLt2zUKI9BopAe4NHyk5PqclgW+//VYefvhhyZAhgyQlJUmZMmXk7rvvVueoBR09elQWL14sqBmtW7dOypYtq2U6dYk0BUiXnGI8Y0KgV69esmfPHlm7dq1ky5YtYJi3bt2S5s2bS/369SU5OTmgH16MDQE2wfw4Llu2TB566KGQP1TbP/30U5+ncV6iRAkpUqSI4EtL5zwCu3fvlk6dOgUVH8Q4S5Ys0qVLF1m5cmW6JmDw4MFSqVIlqVWrljz11FPyyy+/pOv7nBh4ZidGys441a5dW8aPHx8yCt26dZM8efL4+Pvwww/lySef9FTj0ZdA5ywC9erVk61bt0r37t3TjNj69eulWLFiafqJ9uacOXPk+eefV2KIPqmbN29Kjhw5og1Wq+cpQH7ZVbBgQcEvlIP45MyZ08dbxowZ1bVEK0Q+EBx+0r59e4EIfffdd9KhQwfVx4MOaOQd+oCOHTsmc+fOleXLl6tmWnomJ3PmzKrzG0KHzvBEdBSgRMz1BE5z9erVZe/evdKjRw/p3LlzwGZP06ZNZfXq1dKoUSPLpCBix48fD/kcmui3b98O6c/tHihAbs9hpi8VgXLlyqkRrp9//lmJBWo96HguWrSoFC9eXNVKUj0U5oUtW7bIsGHDQvo+ePBgwjW3AkGhAAWiwmsJQQDNHogRfnB37tyRs2fPRpV2dCbjF8phoAPCl+iOo2CJXgISMP0QmUmTJqkh9gMHDigCqLUULlxY1YBQE/If4UxATHFJMmtAccHMlziFAMQH83vQT4Ma0IQJE+Ttt9+W0aNHS5s2beTBBx8UjE7heNu2bfLAAw84JequjAdrQK7MViYqGIFx48bJXXfdpeZpQYQw4RBD4QMHDlTC89JLL8l//vMfJURjxowJFgyvx4gABShGIBmMHgR27NihJhmimYXh9yFDhqiIt2vXzicBGCH76quvfK7xJPYEKECxZ8oQHUwAi02xFMN0lStXFtR0sBDV233++edqkar3NR7HngAFKPZMGaKDCaCmgz6eP/zhD3LixAkV0wEDBnhmPZ88eVJ69+4tH3zwgWDSIl36EqAApS9fhu4wAuiAXrhwoaApdujQoVSxwyzoyZMnKxGCSNGlLwFXjYKdO3dOLYXInTt3+lJj6FoTaNWqlbRo0ULN+/FPSMeOHdUMaQzJ06U/AS1rQPh6YdHn1atXFaHPPvtMGZcqVKiQ5MuXT60u3rx5c/rT4xu0JZApU6aA66+wLoviE79s1U6Atm/fLnXr1vV8vTBXo3Xr1mpEA52JWMmOGlCzZs2EIhS/gsQ3kUAkBLRrgs2bN0/VfpYuXarSO23aNPXFgjBhdTEcOhGxoBAdiQ0aNFDXwv0H1vBefvnlkN7PnDkjWM8DMYzUYTFi1apVVU0Oq+uxSBK2aOhIIFEIaCdAO3fu9BmduHz5srRs2dIjPmbGYQQDnYlW3RNPPBHW7FfUumBTOBr3008/yZEjR+Tdd9+VPn36yI8//kgBigYon9WOgHYCVK1aNVm0aJF07dpVsmfPLo888oiaxzFx4kRBux4O9nxXrFghFStWtJwhaL6F04mNd8fChgtqbei7MuNuOcJ8gAQ0JqCdAMFyHExY1qlTR2DSEsal7rvvPmW7BcOmaMpgKHXVqlXK8p3GecOok4DrCWgnQCVLlpRNmzbJiBEjBEOmMKFgOpjahKtRo4agjwhCRUcCJOBcAtoJEFDCkPdHH32kTCpgGxXs83TlyhVlUApG4StUqOBc4oyZqwlgk8PDhw+HTCOmkAQzQo8yffr0aRUGuhGwbZBbnZYCZGYGFhPiR5MJJhH+bzcBzFEbOXJkyGjAJGugbYEgTNirrEqVKkqEsPuKmxfFai1AIXOZHkggzgR++9vfCn6hXDCLiDATC3Mh6GL45ptv5P333w8VlNb3tZuIqDVtRp4ESMCHAAXIBwdPSIAE4kmAAhRP2nwXCZCADwEKkA8OnpAACcSTAAUonrT5LhIgAR8CFCAfHDwhARKIJwEKUDxp810k4EcA836wT32iOs4DStScZ7odQQCLqC9cuKAWUDsiQnGOBGtAfsBnz56tzLrmzJkzzf9hf+iLL77we5qnuhGA5QQsn7h06ZItUS9SpIhg8qH3mkZbImLTSylAfuBhR+jixYshf9hBE2vOpk+fLli7Q6cPAawdhFUF2HOCSRUsd8CSHmzNg217+vfvL9euXYtLgh5//HH1HqwLgxAmmmMTzC/HYZcnR44cfldTn2bMmFHtL9WrVy956qmnuJd4akSOvII1WA8//LBkyJBBkpKS1LorLPbEOWpB+JjAKuaSJUtk3bp1UrZs2XRNB2xQ42OG3VixX/0rr7ySru9zWuAUoChyBIbE4GClkU4PArAbjprP2rVrAy4GRSpGjRqltmyeNWuWJCcnp3vCIIQQoKlTp8qLL76Y7u9z0gvYBIsiN/D1wsJBmE7AlkB0ziewe/du6dSpU1DxQQpgl7tLly6ycuXKuCSofPnyqgaGETG3Lz71B0oB8idi4RzVdvQZwKFg0zmfACxomobr0ort+vXrPbulpuUvVvdMk7wTJkyQW7duxSpYx4fDJliUWQTri9j+B3uJ0zmfAAYZIEKYe9OhQwfVx4MOaPTpoQ/o2LFjyqTv8uXLVTMtXinC+zt37iwffviheiWaf4in2x0FKMocrl69ugqBNaAoQcbpceQXtj/q0aOH+oMPZJUQWzqtXr1a2Rm3Gi1s1/Tll1+GfAwWPP3fPWXKFEFzbOjQofL3v/9dGSLDzinor4KDHXTYPHeTowBFmZuoAcGhBgQrdnTOJ1CuXDk1woX5N8ePH1e1HjR7ihYtKsWLF1dD8pGmAuKGju5QDlMBAu2qAmGERUXslmJaQhw4cKAStccee0ywC7CbHAUoytyEfWp0Wh46dEjtzhFlcHw8jgSQbxAj/Pwd9miDC2dKhvezmNdjzu3xvu5/HMwiIvxBfIYPH67mKt28eVPVejA3yY2jreyE9i8ZFs/xFatcubKqTqNaTed8AuhfKV26tNpXDkIQqFMafUXok7HLYapA27Zt1egYdoHZsGGDXVFJ1/dSgGKA1+wHwi6tdM4msGbNGiUs2N4JW3Bj9nHDhg3V7rROi3nhwoUlX758Klr//e9/U/UZOS2+kcTHVQJ0/fp1OXHiRCQconrG7AeiAEWFMS4PY7IfmkgbN25Uht/RdEanb+/evT0jUHGJSJgvwc4ZmI2Nppgbl2q4SoAwcmCKQZj5GxNv5jsTeVVzTEDGIRAsxXjyySc9b8JcLvS3DBkyRLp37+4ZcfJ4cMABamhwZ8+edUBsYhsF7Tqhx44dq0YtAmH4+uuvBbUgrM+Cq1mzptpDPpDfWF5DP8K9996rRlS4MDWWZGMfFka6MMnQLCPmGzDyhNoz+l3Q5+Ikh7VrM2fOVDUglK/cuXNLgQIFVP+Qk+IZSVy0E6Bdu3bJ/PnzJX/+/KlmqqIJhOHUf/7zn4pFoI3fQkG6ffu2mCMgafmF+QRzHgdGLfr166d+WNODxYXB3I0bNwTvgLkPuvgTQOcytvRGbadnz54+NeYZM2YoAWrUqJEaiscHzAkOEyVhtgNzjDDVA2UIM6b79OnjhOhFFQftmmBz585ViwUhNFjTs2fPHtm3b5/6YREhOu3M83HjxlmGA3HDGq9QPwjhgQMHPOF369ZNDcdjfkcw2zLYaC5XrlzK7AP3rfegi+tBu3bt5PXXXxfYfcLP2+FDsmDBAmnVqpUcOXLE+5btx6i5wcEEDOYK7d+/3/Y4xSIC2gkQpqwPHjxYdSLCFk/jxo0F7fpYOXwdf/jhh5C/2rVrqz3qzfeiWowtdeEgTIEMTKGKj7Vjf/3rX1X45rP8P74EXnvtNUFtGRP8/B1qzWjubNu2TdWU/O/bdY4JknD44IZTQ7crnlbfq50AmQlEDQJDk5iDU61aNUeMYGBCGya3YWU8VjVzVMzMLef9nz17dsEwdzCHZQ+w8xQvh+Y8avCYRQ0rjf4OwohlGPDntNqZf1ytnGvXB+SdOPSjoDaBvbi7du1qedaqd1ixOEahRicmRuMwvIvqMkZcMIUeNZ9AtaJYvJdh6E8A/YJoVsEkB5aIBHKw2Ij7J0+e9Kl9B/KryzWtBciEDAFCv89LL71k+1wJdBaiExMLElFQ0LGJHxyaaRCpRN4Fwcwz/u9LAF0Lv/vd75SB+i1btvje/L8zc1nI999/H/C+jhddIUAAD7u+8+bNc0QeoGbWt29fNeFt2bJl8u9//1utwMYQKmwN//nPf45qwaMjEslIxJ0AmmGwG4Q+StSY3OBcI0BOzAwMmXqvkEenOab/4wuGWa3mdAEnxp1xch4BTJrEaBgGM9zSv6htJ7TzikfoGKGTGhMWmzRpojyjym3OJQr9NH2QgKjyAw5uaYZRgGwo1W3atFETEdGh6JaqtA0YE/KV+IDBuUWA2ASzoRijKo2Z3JjRipEx/E/nDgJoHoVjHRMCEknt1xQgbISwdOlSZUrWe22bbhQpQDblGOYLNWjQQNmTZl+QTZmQDq89ePCgvPfeeyFDxkgoZl5bdaYAoQ/xrbfeUgMc6FvENBQdnXUCOqbSoXF+7rnnlACtWrXKoTFktKwSePTRRwW/UC4ti4hpPYvJk6hBY7Iipp1gyRDWiOnq2AdkY861aNFCvf2YsRMDJynamBEavdp7514093R3FCAbcxDmXM1qOAXIxozQ7NWmJQUY1NfdUYBszkHMgIWLpEPS5qjz9TYRgEUFODcIEPuA/AoRZpmGs1QCK5IxkoFOR3yRzNXKfsHJ4cOHlbig3Y4qs7nQEMPvWC+G63AQIIqQPz2eByLgXQOCuVadHQXIL/ewCdwrr7zidzX1KcQE+4djaQWG0c09nLx9YndNrFPzdpiMCJHDOjHYJkbTC8tIsIIeFh2xCpuOBNIiYAoQyiAFKC1SGt57+umnBb9QzhzFgPmEadOmBaw1QZRg3Aqrmy9evKiWZcAYOna7xDyg0aNHK8t8v/71r5UAwcgZBSgUed7HgmY03WGDXPd95NkH5IDybG6MB/tGdCQQigCa7WY/EGrTOjsKkANyD/uBw6EGREcC4RCgAIVDiX7CImC242GQCvs/0cWPAAYFMKs4mB3v+MXE2ptgWwqONSBr3Og7AAG06VGtxshYOOuIAgTBSxYIYOOAQYMGSSlj+2PMxcIgAHaegMVBWK7EPuwYXHCyM42T6b6OkKNgDill6FTEiBi29WFHdPplCjYwwD5bEPykpCS1kcDdd9+tzlELgtG4xYsXy5IlS2TdunWOHWXCRwsO++Dp7ChADsk9U4A+//xzh8TIndHAqCVqPphuEWzfOBiHb968ucyaNUuSk5MdCcKsAekuQOyEdkjxMmdEu2nHA4eg9YkGmrjYTy6Y+MAzLBVgjtfKlSt9nnXSCZqO+GEYXud+QwqQQ0qVOSOaApS+GVKvXj3ZunVryJdg+2asNHeyQ98VnM7GydgEc0gJgwBhpTMMTeGLltYX2iFR1jIa2JoZIoTlNh06dFB9POiARg0UfUCwTIDddzGLHc00JzsIEGbU62wfmgLkkBIGAYKxKXSC4o8Ae4rRxZ5A9erV1Q4l2N64c+fOAdffNW3aVFavXq22V7IaA+Tfjh07Qj6GWczRrv1jDSgk5vT1gDkcZtPF/03m9rVmZ53/fSeeo3MUBRh7yFOA0i+HMPMcI1xYIoMV5RB89KVgxwksKkaNKFKH8D7++OOQj6PZFKzshnz4/zyYAsQaULjEYuQPoxPDhg1TzZWaNWvK2LFjpX79+j6ho6qNzsSFCxf6XHfyCQQIDgJEl/4E0IkLMTKXwsTijdiUEr9QzlxLGMpfWvdNAdK5D0i7Tug1a9aoqnPJkiXVHluYxdqwYUN5991308orLe5RgLTIJsdE0g0CpF0f0NSpU5UZC3OIFLuMojbUu3dvyZMnjxKnaEoIzGLAxk8ohynwZhseEwj37t0rV65cCfVY0PsIyxxORR8CtpquWrVqUP+8QQKmALEJFseygJms6Dw0HdrRw4cPV7OIu3fvroZO0YkYqdu5c6e8+eabIR+HLRZzpMqc2o8+qWrVqoV8NpAHmOiYPXu2uoWtnBEOJiWi05QudgQeeOAB+fLLL8MKEGZZ5syZE5ZfOzzly5dPjd6hvxN7zOEDrJvTrgaEjkLM0ejVq5cP65EjRyqLg23btpVNmzb53LNy8pvf/EbwC+W82/AYwh06dKhMmTIl1GNB78M29Ouvv67sA2E4HgKk2wLJoIlz0I3x48cLNoZEB/Srr76q/oCDRc+0UhDsvhOuY1U8xAcd6TrWmLUTIHQud+zYUf2h9uzZU2rUqOEpBzNmzBAIEDoBMZKBDmqdnGliAX8cuhuacip37MW2ZcsWVbNE03nAgAFOjWpY8TIFCC0DHQVIu07odu3aqZoCmitmk8XMKdQiFixYoKwQ6jqj2FySARGiSx8CqNmg73DEiBHKUmX6vCU+oZrmWVED0tFpVwMC5Ndee02NgAXqfEO/zMyZM+WFF14IaCbV6ZkEAfLukHZ6fHWNX9++fVUNGbUgnZ1Za6YAxTkXYY4Au0QGc7qatDAnp7EGFCxnY3Md/WyNGzeOTWA2hqJ7DUi7JpiNeR2XV5tNMHNIPi4v5Uu0JaB7DYgC5LCixxqQwzLE4dFhDcjhGaRb9MwaEJtguuWcPfFFVwQGX7Dtk9PNyAYixBpQICo2XkMNCD8IkDnT2sbo8NUaEMCERDgdO6IpQA4rYBCfu+66S8VK9x0PHIbWtdHBJpdwFCDXZnF8E2aagwg0zSC+MeHbdCBgCpCOc99YA3JgCcMuDXAUIAdmjgOjZC5Kxb5yujktJyLqBtlqfFkDskrMOf4PHz4smzdvDhkhWF2IRR8fFkCbVhg2btwY8r1O80ABclqOGPFhDciBmRJmlM6ePRuWAGEBKcQjWgfTMTDdAgfxw35mWGyri6MA+eUUFvVhc8BQDsOewb5guL5nz55QQQS9bwqQ+WUL6pE3HEcAmx7iF8p5W1MI5Tet+1i0DOP6K1asUNYTdLOmSQHyy11kIBa0hnIQIHPOjr9ffIlMmzMtWrTwvx3y3GyC6WxqM2Qi6SGmBGAhFOZbsEuGTo4C5JdbWB8UzhqhtL5g+Cp1MTa2Q6dgJNVsc1SDw/B+mcPToARKGfbEYcBONwHiKFjQLLXvBozpY3ar7iu17SOYeG9GDQgOljp1chQgh+aWae7VodFjtBxGgALksAzRPTrYMoaOBMIlgP3MMIseO77CvrgujjUgh+YUBcihGePQaKHZjpXx6HM0B0AcGlWfaFGAfHA454QC5Jy80CUmpm0gc16QDvGmADk0lyhADs0YB0crd+7cKnbYo04XRwFyaE7BzgsdCVghYAoQa0BWqNFvQAKoARUsWDDgPV4kgUAEKECBqPBaxATKlSsX8bN8MPEIoNaMH9ajXbhwQQsAbII5OJvKli3r4Ngxak4jgGH4YsWKqWhh92AdnPYChGHH8+fPu3IbY0yvp0tfAm4qP6dOnRLTKBk28NShL0hLAQLoQYMGCf5A0VcCg0xYwJk3b165//77pX///loa6Pb/U8PcDrrYE3Br+bl+/br06dNHKlWqpKBNnDgx9vBiHKJ2i1FhLgPmDlDdTEpKkjJlyij7OTjHauCjR4/K4sWLlV2UdevWCZsxMS4xmgfn9vKDv4N+/fqpnYEPHDjg+NzSToDGjBkjpYyaz9q1ayXYeqlRo0ZJ8+bNZdasWZKcnGwpE5BpEK5QDh19mPK+fft2uXHjhpp9ChMdWI18/Phxue+++9R1mNS4ffu2sloHo+EwRAVbQXhmw4YN6t6yZcvU/0gTVtLv2LFDrWwOFQfet07AieUH5Rg2pNasWaPKBTalRJk4ffq0oFaD4zNnzgisI+AY2++g7OEY5mPw94BjdEWgdoeypctC5gxGGzh6s2zWy0HET6D207lzZ+nevXuaYcyZM0cmTZqkBCJNj343t23bJng2lIPpg9atW8uhQ4fU9HdkOL4++B+FCVjRhMI5VrbDmfaD4M88h19ch3/8zDDQmTh06FAVhvLMf2JCwInlB/nvXQ6QULMc4B6O8RGDQ1nClk0oKxAuCBSOMQSPjxd+WJJRqFAhefnll8WcHa0eduA/2tWA6tWrJ1u3bg0pQBgFMEcErHCvW7eu4EfnTgIsP87KV+0EqH379oJChFW/MEWJPh50QONLgT4gNHPmzp0ry5cvV800Z+FmbOwmwPJjdw74vd+ovmnnjGZPSpMmTVIM0UHzMdWvadOmKUYNSLt0McLxIcDyEx/O4bxFuz4gb/1EWxgdvqj1oO1btGhRgV0U06ayt18ek4A/AZYffyLxP9dagOKPi28kARKIJQEtJyLGEgDDIgESsI8ABcg+9nwzCSQ8AQpQwhcBAiAB+whQgOxjzzeTQMIToAAlfBEgABKwjwAFyD72fDMJJDwBClDCFwECIAH7CFCA7GPPN5NAwhOgACV8ESAAErCPAAXIPvZ8MwkkPAEKUMIXAQIgAfsIUIDsY883k0DCE6AAJXwRIAASsI8ABcg+9nwzCSQ8AQpQwhcBAiAB+whQgOxjzzeTQMIToAAlfBEgABKwjwAFyD72fDMJJDwBClDCFwECIAH7CFCA7GPPN5NAwhOgAEVZBLCjZbTO2L4k2iD4vKYEYlF+kPRYhRNvjBSgCIkfPXpUHnnkEbUxYrNmzdSmiFaD2r9/v9rDvmbNmvLss8/KuXPnrAZB/5oSwEfnhRdekIoVK6oytGnTpohS8tlnn0mlSpWkWrVq0rVrV+2EiAIUUbaLKjwoQEeOHJFatWrJG2+8YTmk5ORk6dKli2Cf+fLly8vkyZMth8EH9CQwffp0uXz5suAj9NFHH8nvf/97z/7v4abo+++/lz/+8Y+yYsUK2bt3r9y4cUOWLFkS7uOO8EcBiiAbbt++LTt37pRnnnlGbQnds2dPWbp0qeWQLly4IJkz///dsXPmzClnzpyxHAYf0JPAqlWr1McnS5YsUqdOHSlSpIj6EFlJzSeffCJPPPGEFC5cWG1VPn/+fElKSrIShO1+tdsb3nZiRgROnDghBQoUUOKD+BQqVEjOnj1rOWpTp06V+vXrC2pC+Hpt27bNchh8QE8CaMJDdEwHEbH6AcKuwKdPn5YqVaoIPmD33nuvqk3lyZPHDNbx/7MGFEEWYUtfY196z5MZMmRQ51Y7k9FmRxV6zpw50rBhQxk6dKgnTB64mwDKUKZMmTyJRBnCz4q7du2a7Nu3TzXj9uzZI/nz55dFixZZCcJ2v//7K7I9KvpEAHvQnz9/3hNhNKVKlixpqQB9++23gq/gsGHDVAfiO++8o75ed+7c8YTLA/cSQBnyHnRAeSpdurSlBCOMJk2aSLZs2dRzOF6/fr2lMOz2TAGKIAdQxa1QoYKsXLlSPT179mxp1KiRpZBKlCgh+fLlU805PLhr1y7VF+D9VbQUID1rRQB9N/PmzVOjVgcPHpRTp05JuXLlLKXh8ccfly1btsjVq1fVcyiPGFHVyWUwmg2chBJBju3YsUNat24tBQsWlFy5csk//vEPVQW2EtTy5ctlwoQJcvPmTcmaNauMGDFCateubSUI+tWUwPXr16Vly5ZKeDCoMWnSJNWhbDU548ePlylTpkiOHDnUcD46olGWdHEUoChyCtqNoVS0vaNxaMvnzp07miD4rKYELl26pMqP1f4f7+TeunVLDWLkzZvX+7IWxxQgLbKJkSQBdxJgH5A785WpIgEtCFCAtMgmRpIE3EmAAuTOfGWqSEALAhQgLbKJkSQBdxKgALkzX5kqEtCCAAVIi2xiJEnAnQQoQO7MV6aKBLQgQAHSIpsYSRJwJwEKkDvzlakiAS0IUIC0yCZGkgTcSYAC5M58ZapIQAsCFCAtsomRJAF3EqAAuTNfmSoS0IIABUiLbGIkScCdBChA7sxXpooEtCBAAdIimxhJEnAnAQqQO/OVqSIBLQhQgLTIJkaSBNxJgALkznxlqkhACwIUIC2yiZEkAXcSoAC5M1+ZKhLQggAFSItsYiRJwJ0EKEDuzFemigS0IEAB0iKbGEkScCcBCpA785WpIgEtCFCAtMgmRpIE3EmAAuTOfGWqSEALAhQgLbKJkSQBdxKgALkzX5kqEtCCAAVIi2xiJEnAnQQoQO7MV6aKBLQgQAHSIpsYSRJwJwEKkDvzlakiAS0IUIC0yCZGkgTcSYAC5M58ZapIQAsCFCAtsomRJAF3EqAAuTNfmSoS0IIABUiLbGIkScCdBChA7sxXpooEtCBAAdIimxhJEnAnAQqQO/OVqSIBLQhQgLTIJkaSBNxJgALkznxlqkhACwIUIC2yiZEkAXcSoAC5M1+ZKhLQggAFSItsYiRJwJ0EKEDuzFemigS0IEAB0iKbGEkScCcBCpA785WpIgEtCFCAtMgmRpIE3EmAAuTOfGWqSEALAhQgLbKJkSQBdxKgALkzX5kqEtCCAAVIi2xiJEnAnQQoQO7MV6aKBLQgQAHSIpsYSRJwJwEKkDvzlakiAS0IUIC0yCZGkgTcSYAC5M58ZapIQAsCFCAtsomRJAF3EqAAuTNfmSoS0ILA/wPJ7NJnlOwOCQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Clearly, there are now strong differences in the community
distributions: the larger guild has a much broader distribution, with
much less singletons than the smaller guild. Again, we can use maximum
likelihood to infer the parameters from the data:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>LL1 <span class="ot">&lt;-</span> <span class="fu">maxLikelihood.Guilds.Conditional</span>(<span class="at">init_vals =</span> <span class="fu">c</span>(theta, alpha_x, alpha_y), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">model =</span> <span class="st">&quot;D1&quot;</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sadx =</span> abund<span class="sc">$</span>guildX, <span class="at">sady =</span> abund<span class="sc">$</span>guildY,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Maximum likelihood estimation shows that we can accurately infer the
underlying parameters. Furthermore, we can test whether the model
assuming differences in dispersal between guilds better explains the
data, than the model without. We do this by also fitting the model
without differences to the data, and compare the estimated
likelihoods:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>LL2 <span class="ot">&lt;-</span> <span class="fu">maxLikelihood.Guilds.Conditional</span>(<span class="at">init_vals =</span> <span class="fu">c</span>(theta, alpha_x), </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">model =</span> <span class="st">&quot;D0&quot;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">sadx =</span> abund<span class="sc">$</span>guildX, <span class="at">sady =</span> abund<span class="sc">$</span>guildY,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>To do an honest comparison, we have to correct for the extra
parameter (alpha_y) in the âD1â model, we do this by calculating the AIC
value:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>AIC_D1 <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> LL1<span class="sc">$</span>fvalues</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>AIC_D0 <span class="ot">=</span> <span class="dv">2</span> <span class="sc">*</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> LL2<span class="sc">$</span>fvalues</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>AIC_D1</span></code></pre></div>
<pre><code>## numeric(0)</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>AIC_D0</span></code></pre></div>
<pre><code>## numeric(0)</code></pre>
<p>Clearly, the AIC of the D0 model is much lower, indicating a much
better fit - as expected.</p>
<p>This concludes the vignette. Go out there, find abundance data and
check whether the data has guild structure! If not, use the ESF, but if
you can come up with a potential guild structure, apply the conditional
guilds sampling formula! Donât forget to apply both the model with, and
without differences in dispersal ability, in order to verify that the
guilds really differ in dispersal ability!</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
